String flowApiName = 'Your_Screen_Flow_API_Name';

// Step 1: Get the Flow Definition View
FlowDefinitionView defView = [
    SELECT Id, DeveloperName, DurableId
    FROM FlowDefinitionView
    WHERE DeveloperName = :flowApiName
    LIMIT 1
];

// Step 2: Get the latest version
FlowVersionView latestVersion = [
    SELECT Id, VersionNumber, Status
    FROM FlowVersionView
    WHERE FlowDefinitionViewId = :defView.Id
    ORDER BY VersionNumber DESC
    LIMIT 1
];

System.debug('Latest Version: ' + latestVersion.VersionNumber + ' | Status: ' + latestVersion.Status);

// Step 3: Activate by updating FlowDefinition’s ActiveVersionId
// Use DurableId from the FlowDefinitionView to get writeable FlowDefinition
List<FlowDefinition> flowDefs = [
    SELECT Id, DeveloperName, ActiveVersionId
    FROM FlowDefinition
    WHERE DurableId = :defView.DurableId
    LIMIT 1
];

if (!flowDefs.isEmpty()) {
    FlowDefinition flowDef = flowDefs[0];
    
    if (flowDef.ActiveVersionId != latestVersion.Id) {
        flowDef.ActiveVersionId = latestVersion.Id;
        update flowDef;
        System.debug('✅ Flow activated successfully!');
    } else {
        System.debug('ℹ️ Latest version is already active.');
    }
} else {
    System.debug('❌ Could not find writable FlowDefinition record.');
}
