tail -n +2 scanner-report-partial.csv | while IFS= read -r line; do
  fixed_line=$(echo "$line" | awk '
    BEGIN { FPAT = "([^,]*)|(\"[^\"]+\")" }
    {
      for (i = 1; i <= NF; i++) {
        if (i == 4) {
          gsub(",", "|", $i);  # Replace commas inside the 4th column (tags) with |
        }
        printf "%s", $i
        if (i < NF) {
          printf ","
        } else {
          printf "\n"
        }
      }
    }
  ')
  echo "$fixed_line"
done >> scanner-report.csv
