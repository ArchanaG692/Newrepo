- name: Get Repository and Branch Info
  shell: bash
  run: |
    set -euo pipefail

    REPO_NAME="$(echo "${GITHUB_REPOSITORY}" | cut -d'/' -f2)"

    # âœ… Target branch for PRs (base branch)
    if [[ "${GITHUB_EVENT_NAME}" == "pull_request" ]]; then
      TARGET_BRANCH="${GITHUB_BASE_REF}"
      SOURCE_BRANCH="${GITHUB_HEAD_REF}"
    else
      TARGET_BRANCH="${GITHUB_REF#refs/heads/}"
      SOURCE_BRANCH="${TARGET_BRANCH}"
    fi

    COMMIT_LABEL="$(git log -1 --pretty=format:'%s')"

    echo "REPO_NAME=${REPO_NAME}" >> "$GITHUB_ENV"
    echo "TARGET_BRANCH=${TARGET_BRANCH}" >> "$GITHUB_ENV"
    echo "SOURCE_BRANCH=${SOURCE_BRANCH}" >> "$GITHUB_ENV"
    echo "COMMIT_LABEL=${COMMIT_LABEL}" >> "$GITHUB_ENV"

    echo "Target Branch = ${TARGET_BRANCH}"
    echo "Source Branch = ${SOURCE_BRANCH}"
